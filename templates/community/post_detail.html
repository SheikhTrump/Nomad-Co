{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <h2 class="mb-2">{{ post.title }}</h2>
  <div class="mb-3">
    <span class="fw-bold">{{ post.user_name }}</span>
    <span class="badge bg-info text-dark">{{ post.user_type }}</span>
    <span class="text-muted ms-2">{{ post.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
  </div>
  <div class="mb-4">{{ post.content }}</div>
  <hr>
  <h4>Answers</h4>
  <ul class="list-group mb-4">
    {% for reply in post.replies %}
      <li class="list-group-item">
        <strong>{{ reply.user_name }}</strong>
        <span class="badge bg-info text-dark">{{ reply.user_type }}</span>
        <span class="text-muted ms-2">{{ reply.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
        <div>{{ reply.content }}</div>
      </li>
    {% else %}
      <li class="list-group-item">No answers yet.</li>
    {% endfor %}
  </ul>
  {% if current_user.is_authenticated %}
    <form method="POST" action="{{ url_for('community.reply_to_post', post_id=post._id) }}" class="card p-3 shadow-sm">
      <div class="mb-3">
        <label for="content" class="form-label">Your Answer</label>
        <textarea name="content" id="content" class="form-control" rows="3" required></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Reply</button>
    </form>
  {% else %}
    <p><a href="{{ url_for('auth.login') }}">Log in</a> to reply.</p>
  {% endif %}
</div>
{% endblock %}
